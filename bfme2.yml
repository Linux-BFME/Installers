name: The Lord of the Rings - The Battle for Middle-Earth II
game_slug: BFME2
version: All patches
slug: bfme2slug
runner: wine

script:
    files:
    - bfme2: https://gitlab.com/dginovker/dump_bfme-ii/-/archive/master/dump_bfme-ii-master.zip
    game:
        arch: win64
        exe: $GAMEDIR/drive_c/windows/explorer.exe
        args: /desktop=bfme2
        working_dir: $GAMEDIR/
        prefix: $GAMEDIR
    installer:
    - task:
        arch: win64
        name: create_prefix
        prefix: $GAMEDIR
    - extract:
        description: Installing the game
        file: bfme2
        format: zip
        dst: $GAMEDIR/
    - task:
        arch: win64
        description: Patch multiplayer
        key: 
        name: set_regedit
        path: HKEY_LOCAL_MACHINE\Software\Wow6432Node\Electronic Arts\Electronic Arts\The Battle for Middle-earth II\ergc
        prefix: $GAMEDIR
        value: '$GAMEDIR$CACHE'
    - write_file:
        file: $GAMEDIR/drive_c/users/$USER/Application Data/My Battle for Middle-earth(tm) II Files/Options.ini
        content: |
            AllHealthBars = yes
            AmbientVolume = 60.000000
            AudioLOD = Low
            Brightness = 50
            FlashTutorial = 0
            GameSpyIPAddress = 10.147.19.145
            HasSeenLogoMovies = yes
            IdealStaticGameLOD = Low
            MovieVolume = 49.000000
            MusicVolume = 57.000000
            Resolution = $RESOLUTION_WIDTH $RESOLUTION_HEIGHT
            SFXVolume = 59.000000
            ScrollFactor = 64
            SendDelay = no
            StaticGameLOD = Medium
            TimesInGame = 63
            UseEAX3 = no
            VoiceVolume = 48.000000
    wine:
        dxvk: false
