name: Lord of the Rings - Battle for Middle Earth 1
game_slug: BFME1
version: Patch 1.06
slug: bfme106slug
runner: wine

script:
    files:
    - bfme: https://gitlab.com/dginovker/Dump_BFME-I/-/archive/master/Dump_BFME-I-master.zip
    game:
        arch: win64
        exe: $GAMEDIR/drive_c/Program Files (x86)/EA GAMES/The Battle for Middle-earth (tm)/lotrbfme.exe
        working_dir: $GAMEDIR/drive_c/Program Files (x86)/EA Games/The Battle for Middle-earth (tm)
        prefix: $GAMEDIR
    installer:
    - input_menu:
        description: 'Choose which CD Key ID to use (for multiplayer, every user needs a different one, otherwise you will see "Serial in use" error)'
        id: CD_KEY
        options:
        - AA: AA
        - AB: AB
        - AC: AC
        - AD: AD
        - AE: AE
        - AF: AF
        preselect: AF
    - task:
        arch: win64
        name: create_prefix
        prefix: $GAMEDIR
    - extract:
        description: Installing the game
        file: bfme
        format: zip
        dst: $GAMEDIR/
    - task:
        arch: win64
        description: Patch multiplayer
        key: 
        name: set_regedit
        path: HKEY_LOCAL_MACHINE\Software\Wow6432Node\Electronic Arts\EA Games\The Battle for Middle-earth\ergc
        prefix: $GAMEDIR
        value: 'GP3T..$INPUT_CD_KEY'
    - write_file:
        file: $GAMEDIR/drive_c/users/$USER/Application Data/My Battle for Middle-earth Files/Options.ini
        content: |
            AllHealthBars = yes
            AlternateMouseSetup = no
            AmbientVolume = 70
            AudioLOD = High
            Brightness = 50
            FirewallNeedToRefresh = TRUE
            FixedStaticGameLOD = Medium
            FlashTutorial = 0
            HasGotOnline = yes
            HasSeenLogoMovies = yes
            HeatEffects = yes
            IdealStaticGameLOD = UltraHigh
            IsThreadedLoad = yes
            MovieVolume = 80
            MusicVolume = 60
            Resolution = $RESOLUTION_WIDTH $RESOLUTION_HEIGHT
            SFXVolume = 100
            ScrollFactor = 50
            StaticGameLOD = Medium
            TimesInGame = 24
            UnitDecals = yes
            UseEAX3 = no
            VoiceVolume = 80
